version: 2.1
aliases:

        - &dependencies
           - checkout
           - run: yarn install

        - &test_environment
            docker:
              # replace with your preferred image
              - image: circleci/node:14
jobs:
  Snapshot-test:
            <<: *test_environment
            steps:
              - run : *dependencies
              - run:
                  name: Run Snapshot Tests
                  command: yarn chromatic test --exit-zero-on-changes --project-token $CHROMATIC_PROJECT_TOKEN
  Unit-test:
          <<: *test_environment
          steps:
            - run : *dependencies
            - run:
                name: Run Unit Tests
                command: yarn test

workflows:
  chromatic-snapshot-test:
    jobs:
      - Snapshot-test
      - Unit-test

